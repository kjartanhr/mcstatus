import { status, statusBedrock, statusLegacy } from 'minecraft-server-util';

// java options
const options = {
    timeout: 1000 * 2.5, // timeout in milliseconds
    enableSRV: true // SRV record lookup
};

const default_img =`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`;

const default_mcimg = `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`;

function handle_exception(res) {
    const img = Buffer.from(default_img, 'base64');
    res.writeHead(200, {
        'Content-Type': 'image/png',
        'Content-Length': img.length
    });
    return res.end(img);
}

export default function handler(req, res) {
    const {address} = req.query;

    if (!address || address == 'default') return (() => {
        const img = Buffer.from(default_mcimg, 'base64');
        res.writeHead(200, {
            'Content-Type': 'image/png',
            'Content-Length': img.length
        });
        res.end(img);
    })();

    // destructure host & port
    const [host, port = 25565] = address.split(':');

    status(host, parseInt(port), options)
        .then(async result => {
            const img = await (() => new Promise((resolve) => {
                if (result.favicon) resolve(Buffer.from(result.favicon.replace(/^data:image\/png;base64,/, ''), 'base64'));
                else resolve(Buffer.from(default_img, 'base64'));
            }))();

            res.writeHead(200, {
                'Content-Type': 'image/png',
                'Content-Length': img.length
            });
            res.end(img);
        })
        .catch(() => handle_exception(res));
};